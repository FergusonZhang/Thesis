# The computational detection of short-term balancing seelction in _Capsella grandiflora_

A thesis submitted to the faculty of Rose-Hulman Institute of Technology by Zhenrui Zhang 
in partial fulfillment of the requirements for the Degree of Bachelor of Science in Biology.

## Code explanation

**parse_the_chromosome:** this program takes a genome VCF as well as a window size number as its inputs. It will parse
the genome into windows with the assigned window size. It will return two pickle files, one for
Tajima's D and one for base pair position.

**Example:** code_parse_the_chromosome.py Cgrand_scaffold_1_shapeit4.vcf 100

**change_the_columns:** this program will refine the recombination possibility maps generated by
the vcftools program, assuming a uniform recombination possibility across each chromosome. It
contains an inner loop so that no input is required.

**analyze_the_scores_Tajima:** this program takes an input number (n). It will plot the Tajima maps 
for all the eight chromosomes as well as select the top n windows form the entire chromosome. The
selected windows will be marked with red dots.

**analyze_the_scores_iHH12:** similar to the Tajima analysis, this program also takes the top
number as its input. However, while plotting the iHH12 maps, it will not show the top windows
in red dots.

**pick_the_genes:** this program has two options: Tajima and iHH12. It will convert selected
windows into gene candidates based on their positions using the _C. rebulla_ reference genome.

**Example:** code_pick_the_genes.py Tajima > Candidates.txt

**plot_the_colormaps:** this program is borrowed from https://github.com/szpiech/selscan/blob/master/src/colormap.plotting.R
It will take the EHH output files and plot the EHH decay curve as well as the haplotype colormap.

**Bash:** this is the shell script that records every I have run for this thesis.

## Results

All the information used in the thesis are included in the Results folder. It contains three subfolders
that record all the plots, as well as two Excels, one has gene candidates and functions, the other
is the result of the GO enrichment analysis.

## Writings

The LaTeX of the thesis can be found in the Writings folder. The LaTeX template is provided by Dr. Williamson.
